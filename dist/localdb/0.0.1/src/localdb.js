define("localdb/0.0.1/src/localdb",[],function(r,t,e){"use strict";var i,n,s,l;s=r("localdb/0.0.1/src/lib/utils"),i=r("localdb/0.0.1/src/lib/collection"),l="ldb_",n=function(r,t){return null==t&&(t=localStorage),this.ls=t,this.name=l+r,this},n.isSupport=function(){return"undefined"!=typeof localStorage&&null!==localStorage?!0:!1},n.prototype.collections=function(){var r,t,e,i;for(i=[],r=t=0,e=this.ls.length;e>=0?e>t:t>e;r=e>=0?++t:--t)0===this.ls.key(r).indexOf(""+this.name+"_")&&i.push(this.ls.key(r));return i},n.prototype.collection=function(r){return new i(r,this)},n.prototype.drop=function(r){var t,e,i,n,s;for(r=null!=r?"_"+r:"",i=function(){var e,i,n;for(n=[],t=e=0,i=this.ls.length;i>=0?i>e:e>i;t=i>=0?++e:--e)0===this.ls.key(t).indexOf(this.name+r)&&n.push(this.ls.key(t));return n}.call(this),n=0,s=i.length;s>n;n++)e=i[n],this.ls.removeItem(e);return!0},e.exports=n}),define("localdb/0.0.1/src/lib/utils",[],function(r,t,e){var i,n;i={},n=function(r){return function(t){return{}.toString.call(t).toLowerCase()===("[object "+r+"]").toLowerCase()}},i.isType=function(r,t){return n(t)(r)},i.isObject=n("object"),i.isString=n("string"),i.isNumber=n("number"),i.isArray=n("array"),i.isFunction=n("function"),i.isRegex=n("regexp"),i.parse=function(r){return null!=r&&i.isString(r)?JSON.parse(r):[]},i.stringify=function(r){return null!=r&&(i.isArray(r)||i.isObject(r))?JSON.stringify(r):"[]"},e.exports=i}),define("localdb/0.0.1/src/lib/collection",[],function(r,t,e){"use strict";var i,n,s;s=r("localdb/0.0.1/src/lib/utils"),n=r("localdb/0.0.1/src/lib/criteria"),i=function(r,t){this.name=""+t.name+"_"+r,this.ls=t.ls,this.deserialize()},i.prototype.deserialize=function(){return this.data=s.parse(this.ls.getItem(this.name))},i.prototype.serialize=function(){return this.ls.setItem(this.name,s.stringify(this.data))},i.prototype.drop=function(){return this.ls.removeItem(this.name)},i.prototype.insert=function(r){return this.deserialize(),this.data.push(r),this.serialize()},i.prototype.update=function(r,t){var e,i,s,l,u,a,c,o;for(i=null!=t.criteria?t.criteria:{},this.deserialize(),o=this.data,a=0,c=o.length;c>a;a++)if(s=o[a],n.check(s,i)){e=r.$set;for(l in e)u=e[l],s[l]=u}return this.serialize()},i.prototype.remove=function(r){var t,e;return null==r&&(r={}),t=null!=r.criteria?r.criteria:{},this.deserialize(),this.data=function(){var r,i,s,l;for(s=this.data,l=[],r=0,i=s.length;i>r;r++)e=s[r],n.check(e,t)||l.push(e);return l}.call(this),this.serialize()},i.prototype.find=function(r){var t,e,i,s,l,u,a,c,o,f,h,p,d,b;for(null==r&&(r={}),t=null!=r.criteria?r.criteria:{},a=null!=r.projection?r.projection:{},s=null!=r.limit?r.limit:-1,this.deserialize(),c=[],b=this.data,f=0,p=b.length;p>f;f++)if(e=b[f],n.check(e,t)){if(0===s)break;s-=1,c.push(e)}if("{}"===JSON.stringify(a))return c;for(u=[],h=0,d=c.length;d>h;h++){e=c[h],l={};for(i in a)o=a[i],1===o&&(l[i]=e[i]);u.push(l)}return u},i.prototype.findOne=function(r){return null==r&&(r={}),r.limit=1,this.find(r)},e.exports=i}),define("localdb/0.0.1/src/lib/criteria",[],function(r,t,e){"use strict";var i,n,s,l,u,a,c,o=[].indexOf||function(r){for(var t=0,e=this.length;e>t;t++)if(t in this&&this[t]===r)return t;return-1};n=r("localdb/0.0.1/src/lib/utils"),u=function(r,t){return n.isNumber(r)&&r===t?!0:n.isArray(r)&&o.call(r,t)>=0?!0:!1},c=function(r,t){return n.isString(r)&&r===t?!0:n.isArray(r)&&o.call(r,t)>=0?!0:!1},a=function(r,t){var e,i,s;if(n.isString(r)&&t.test(r))return!0;if(n.isArray(r))for(i=0,s=r.length;s>i;i++)if(e=r[i],t.test(e))return!0;return!1},l=function(r,t,e){var n,s,l,u,a;switch(t){case"$and":for(s=0,u=e.length;u>s;s++)if(n=e[s],!i.check(r,n))return!1;break;case"$nor":for(l=0,a=e.length;a>l;l++)if(n=e[l],i.check(r,n))return!1;break;case"$not":if(i.check(r,e))return!1;break;case"$or":if(!function(){var t,s;for(t=0,s=e.length;s>t;t++)if(n=e[t],i.check(r,n))return!0}())return!1;break;default:return void 0}return!0},s=function(r,t,e){var s,l,u,a;for(s in e)switch(l=e[s],s){case"$gt":if(r[t]<=l)return!1;break;case"$gte":if(r[t]<l)return!1;break;case"$lt":if(r[t]>=l)return!1;break;case"$lte":if(r[t]>l)return!1;break;case"$ne":if(r[t]===l)return!1;break;case"$in":if(u=r[t],o.call(l,u)<0)return!1;break;case"$nin":if(a=r[t],o.call(l,a)>=0)return!1;break;case"$exist":if(l!==(null!=r[t]))return!1;break;case"$type":if(!n.isType(r[t],l))return!1;break;case"$mod":if(r[t]%l[0]!==l[1])return!1;break;case"$regex":if(!new RegExp(l).test(r[t]))return!1;break;default:if(!i.check(r[t],JSON.parse('{"'+s+'": '+JSON.stringify(l)+"}")))return!1}return!0},i={},i.check=function(r,t){var e,i,o;for(i in t){if(e=t[i],n.isNumber(e)){if(u(r[i],e))continue;return!1}if(n.isString(e)){if(c(r[i],e))continue;return!1}if(n.isRegex(e)){if(a(r[i],e))continue;return!1}if(o=l(r,i,e),null!=o){if(o)continue;return!1}if(!s(r,i,e))return!1}return!0},e.exports=i});