define("localdb/0.0.1/src/localdb",[],function(e,t,r){"use strict";var i,n,s,l;s=e("localdb/0.0.1/src/lib/utils"),i=e("localdb/0.0.1/src/lib/collection"),l="ldb_",n=function(e,t){return null==t&&(t=localStorage),this.ls=t,this.name=l+e,this},n.isSupport=function(){return"undefined"!=typeof localStorage&&null!==localStorage?!0:!1},n.prototype.collections=function(){var e,t,r,i;for(i=[],e=t=0,r=this.ls.length;r>=0?r>t:t>r;e=r>=0?++t:--t)0===this.ls.key(e).indexOf(""+this.name+"_")&&i.push(this.ls.key(e));return i},n.prototype.collection=function(e){return new i(e,this)},n.prototype.drop=function(e){var t,r,i,n,s;for(e=null!=e?"_"+e:"",i=function(){var r,i,n;for(n=[],t=r=0,i=this.ls.length;i>=0?i>r:r>i;t=i>=0?++r:--r)0===this.ls.key(t).indexOf(this.name+e)&&n.push(this.ls.key(t));return n}.call(this),n=0,s=i.length;s>n;n++)r=i[n],this.ls.removeItem(r);return!0},r.exports=n}),define("localdb/0.0.1/src/lib/utils",[],function(e,t,r){var i,n;i={},n=function(e){return function(t){return{}.toString.call(t).toLowerCase()===("[object "+e+"]").toLowerCase()}},i.isType=function(e,t){return n(t)(e)},i.isObject=n("object"),i.isString=n("string"),i.isNumber=n("number"),i.isArray=n("array"),i.isFunction=n("function"),i.isRegex=n("regexp"),i.parse=function(e){return null!=e&&i.isString(e)?JSON.parse(e):[]},i.stringify=function(e){return null!=e&&(i.isArray(e)||i.isObject(e))?JSON.stringify(e):"[]"},r.exports=i}),define("localdb/0.0.1/src/lib/collection",[],function(e,t,r){"use strict";var i,n,s;s=e("localdb/0.0.1/src/lib/utils"),n=e("localdb/0.0.1/src/lib/criteria"),i=function(e,t){this.name=""+t.name+"_"+e,this.ls=t.ls,this.deserialize()},i.prototype.deserialize=function(){return this.data=s.parse(this.ls.getItem(this.name))},i.prototype.serialize=function(){return this.ls.setItem(this.name,s.stringify(this.data))},i.prototype.drop=function(){return this.ls.removeItem(this.name)},i.prototype.insert=function(e){return this.deserialize(),this.data.push(e),this.serialize()},i.prototype.update=function(e,t){var r,i,s,l,a,c,o,u;for(i=null!=t.criteria?t.criteria:{},this.deserialize(),u=this.data,c=0,o=u.length;o>c;c++)if(s=u[c],n.check(s,i)){r=e.$set;for(l in r)a=r[l],s[l]=a}return this.serialize()},i.prototype.remove=function(e){var t,r;return null==e&&(e={}),t=null!=e.criteria?e.criteria:{},this.deserialize(),this.data=function(){var e,i,s,l;for(s=this.data,l=[],e=0,i=s.length;i>e;e++)r=s[e],n.check(r,t)||l.push(r);return l}.call(this),this.serialize()},i.prototype.find=function(e){var t,r,i,s,l,a,c,o,u,f,h,p,b,d;for(null==e&&(e={}),t=null!=e.criteria?e.criteria:{},c=null!=e.projection?e.projection:{},s=null!=e.limit?e.limit:-1,this.deserialize(),o=[],d=this.data,f=0,p=d.length;p>f;f++)if(r=d[f],n.check(r,t)){if(0===s)break;s-=1,o.push(r)}if("{}"===JSON.stringify(c))return o;for(a=[],h=0,b=o.length;b>h;h++){r=o[h],l={};for(i in c)u=c[i],1===u&&(l[i]=r[i]);a.push(l)}return a},i.prototype.findOne=function(e){return null==e&&(e={}),e.limit=1,this.find(e)},r.exports=i}),define("localdb/0.0.1/src/lib/criteria",[],function(e,t,r){"use strict";var i,n,s=[].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1};n=e("localdb/0.0.1/src/lib/utils"),i={},i.check=function(e,t){var r,l,a,c,o,u,f,h,p,b,d,g,k,y,m;for(f in t){if(c=t[f],n.isString(c)||n.isNumber(c)){if(null!=e[f]&&e[f]===c)continue;return!1}if(n.isRegex(c)){if(c.test(e[f]))continue;return!1}switch(u=!0,f){case"$and":for(h=0,d=c.length;d>h;h++)if(r=c[h],!i.check(e,r))return!1;break;case"$not":if(i.check(e,c))return!1;break;case"$nor":for(p=0,g=c.length;g>p;p++)if(r=c[p],i.check(e,r))return!1;break;case"$or":for(o=!1,b=0,k=c.length;k>b;b++)if(r=c[b],i.check(e,r)){o=!0;break}if(!o)return!1;break;default:u=!1}if(!u)for(l in c)switch(a=c[l],l){case"$gt":if(e[f]<=a)return!1;break;case"$gte":if(e[f]<a)return!1;break;case"$lt":if(e[f]>=a)return!1;break;case"$lte":if(e[f]>a)return!1;break;case"$ne":if(e[f]===a)return!1;break;case"$in":if(y=e[f],s.call(a,y)<0)return!1;break;case"$nin":if(m=e[f],s.call(a,m)>=0)return!1;break;case"$exist":if(a!==(null!=e[f]))return!1;break;case"$type":if(!n.isType(e[f],a))return!1;break;case"$mod":if(e[f]%a[0]!==a[1])return!1;break;case"$regex":if(!new RegExp(a).test(e[f]))return!1;break;default:if(!i.check(e[f],JSON.parse('{"'+l+'": '+JSON.stringify(a)+"}")))return!1}}return!0},r.exports=i});