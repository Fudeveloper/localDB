define("localdb/0.0.1/src/localdb",[],function(r,e,t){"use strict";var n,i,s,u;s=r("localdb/0.0.1/src/lib/utils"),n=r("localdb/0.0.1/src/lib/collection"),u="ldb_",i=function(){function r(r,e){this.ls=null!=e?e:localStorage,this.name=u+r}return r.prototype.collections=function(){var r,e,t,n;for(n=[],r=e=0,t=this.ls.length;t>=0?t>e:e>t;r=t>=0?++e:--e)0===this.ls.key(r).indexOf(""+this.name+"_")&&n.push(this.ls.key(r));return n},r.prototype.collection=function(r){return new n(r,this)},r.prototype.drop=function(r){var e,t,n,i,s;for(r=null!=r?"_"+r:"",n=function(){var t,n,i;for(i=[],e=t=0,n=this.ls.length;n>=0?n>t:t>n;e=n>=0?++t:--t)0===this.ls.key(e).indexOf(this.name+r)&&i.push(this.ls.key(e));return i}.call(this),i=0,s=n.length;s>i;i++)t=n[i],this.ls.removeItem(t);return!0},r}(),i.isSupport=function(){return"undefined"!=typeof localStorage&&null!==localStorage?!0:!1},t.exports=i}),define("localdb/0.0.1/src/lib/utils",[],function(r,e,t){var n,i,s,u;n={},s=Object.prototype.toString,u=function(r){return function(e){return s.call(e).toLowerCase()===("[object "+r+"]").toLowerCase()}},n.isType=function(r,e){return u(e)(r)},n.isObject=u("object"),n.isString=u("string"),n.isNumber=u("number"),n.isArray=u("array"),n.isFunction=u("function"),n.isRegex=u("regexp"),n.isSameType=function(r,e){return s.call(r)===s.call(e)},n.keys=function(r){var e;return n.isObject(r)?Object.keys?Object.keys(r):function(){var t;t=[];for(e in r)n.has(r,e)&&t.push(e);return t}():[]},n.has=function(r,e){return null!==r&&void 0!==r&&Object.prototype.hasOwnProperty.call(r,e)},i=function(r,e,t,u){var a,o,c,f,l,h,b,g,d;if(r===e)return 0!==r||1/r===1/e;if(null===r&&void 0===e)return!1;if(void 0===r&&null===e)return!1;if(f=s.call(r),f!==s.call(e))return!1;switch(f){case"[object RegExp]":return""+r==""+e;case"[object String]":return""+r==""+e;case"[object Number]":return+r!==+r?+e!==+e:0===+r?1/+r===1/e:+r===+e;case"[object Date]":return+r===+e;case"[object Boolean]":return+r===+e}if(o="[object Array]"===f,!o){if("object"!=typeof r||"object"!=typeof e)return!1;if(a=r.constructor,c=e.constructor,a!==c&&!(n.isFunction(a)&&a instanceof a&&n.isFunction(c)&&c instanceof c)&&"constructor"in r&&"constructor"in e)return!1}for(b=t.length;b--;)if(t[b]===r)return u[b]===e;if(t.push(r),u.push(e),o){if(d=r.length,g=d===e.length)for(;d--&&(g=i(r[d],e[d],t,u)););}else if(h=n.keys(r),d=h.length,g=n.keys(e)===d)for(;d--&&(l=h[d],g=n.has(e,l)&&i(r[l],e[l],t,u)););return t.pop(),u.pop(),g},n.isEqual=function(r,e){return i(r,e,[],[])},n.parse=function(r){return null!=r&&n.isString(r)?JSON.parse(r):[]},n.stringify=function(r){return null!=r&&(n.isArray(r)||n.isObject(r))?JSON.stringify(r):"[]"},t.exports=n}),define("localdb/0.0.1/src/lib/collection",[],function(r,e,t){"use strict";var n,i,s,u,a;u=r("localdb/0.0.1/src/lib/utils"),i=r("localdb/0.0.1/src/lib/projection"),s=r("localdb/0.0.1/src/lib/update"),a=r("localdb/0.0.1/src/lib/where"),n=function(){function r(r,e){this.name=""+e.name+"_"+r,this.ls=e.ls,this.deserialize()}return r.prototype.deserialize=function(){return this.data=u.parse(this.ls.getItem(this.name))},r.prototype.serialize=function(){return this.ls.setItem(this.name,u.stringify(this.data))},r.prototype.drop=function(){return this.ls.removeItem(this.name)},r.prototype.insert=function(r){var e,t,n;if(this.deserialize(),u.isArray(r))for(t=0,n=r.length;n>t;t++)e=r[t],u.isObject(e)&&this.data.push(e);return u.isObject(r)&&this.data.push(r),this.serialize()},r.prototype.update=function(r,e){var t;return null==e&&(e={}),t=e.where||{},this.deserialize(),this.data=s(this.data,r,t),this.serialize()},r.prototype.remove=function(r){var e,t;return null==r&&(r={}),t=r.where||{},this.deserialize(),this.data=function(){var r,n,i,s;for(i=this.data,s=[],r=0,n=i.length;n>r;r++)e=i[r],a(e,t)||s.push(e);return s}.call(this),this.serialize()},r.prototype.find=function(r){var e,t,n,s,u,o,c,f;for(null==r&&(r={}),u=r.where||{},n=r.projection||{},t=r.limit||-1,this.deserialize(),s=[],f=this.data,o=0,c=f.length;c>o;o++)if(e=f[o],a(e,u)){if(0===t)break;t-=1,s.push(e)}return i.generate(s,n)},r.prototype.findOne=function(r){return null==r&&(r={}),r.limit=1,this.find(r)},r}(),t.exports=n}),define("localdb/0.0.1/src/lib/projection",[],function(r,e,t){"use strict";var n,i,s,u;s=r("localdb/0.0.1/src/lib/utils"),n=r("localdb/0.0.1/src/lib/criteria"),i={},i.generate=function(r,e){var t;return"{}"===JSON.stringify(e)?r:function(){var n,i,s;for(s=[],n=0,i=r.length;i>n;n++)t=r[n],s.push(u(t,e));return s}()},u=function(r,e){var t,n,i,a,o,c,f,l,h,b;o={};for(i in e)if(l=e[i],-1!==i.indexOf(".$")){if(i=i.split(".")[0],!s.isArray(r[i])||0===r[i].length)continue;o[i]=[r[i][0]]}else{if(0===i.indexOf("$elemMatch")){if(!s.isArray(r)||0===r.length)continue;for(a=[],h=0,b=r.length;b>h;h++){n=r[h],t=!0;for(c in l)f=l[c],s.isObject(f)?console.log("TODO"):n[c]!==f&&(t=!1);t&&a.push(n)}return a}s.isObject(l)?o[i]=u(r[i],l):1===l&&(o[i]=r[i])}return o},t.exports=i}),define("localdb/0.0.1/src/lib/criteria",[],function(r,e,t){"use strict";var n,i,s,u,a,o,c,f,l,h=[].indexOf||function(r){for(var e=0,t=this.length;t>e;e++)if(e in this&&this[e]===r)return e;return-1};i=r("localdb/0.0.1/src/lib/utils"),a=function(r,e,t){return n.check(r[e.split(".")[0]],new function(){return this[e.substr(e.indexOf(".")+1)]=t})},c=function(r,e){return i.isNumber(r)&&r===e?!0:i.isArray(r)&&h.call(r,e)>=0?!0:!1},l=function(r,e){return i.isString(r)&&r===e?!0:i.isArray(r)&&h.call(r,e)>=0?!0:!1},f=function(r,e){var t,n,s;if(i.isString(r)&&e.test(r))return!0;if(i.isArray(r))for(n=0,s=r.length;s>n;n++)if(t=r[n],e.test(t))return!0;return!1},o=function(r,e,t){var i,s,u,a,o,c,f;for(s in t)if(u=t[s],"$not"===s)return n.check(r,new function(){return this[e]=u})?!1:!0;switch(e){case"$and":for(a=0,c=t.length;c>a;a++)if(i=t[a],!n.check(r,i))return!1;break;case"$nor":for(o=0,f=t.length;f>o;o++)if(i=t[o],n.check(r,i))return!1;break;case"$or":if(!function(){var e,s;for(e=0,s=t.length;s>e;e++)if(i=t[e],n.check(r,i))return!0}())return!1;break;default:return void 0}return!0},s=function(r,e,t){var u,a,o;switch(e){case"$all":if(!i.isArray(r))return!1;for(a=0,o=t.length;o>a;a++)if(u=t[a],!function(){var t,n,a;for(n=0,a=r.length;a>n;n++)if(t=r[n],i.isArray(u)?s(t,e,u):t===u)return!0}())return!1;break;case"$elemMatch":if(!i.isArray(r))return!1;if(!function(){var e,i,s;for(i=0,s=r.length;s>i;i++)if(e=r[i],n.check(e,t))return!0}())return!1;break;case"$size":if(!i.isArray(r))return!1;if(r.length!==t)return!1;break;default:return void 0}return!0},u=function(r,e,t){var s,u,a,o,c,f,l;for(s in t)switch(a=t[s],s){case"$gt":if(r[e]<=a)return!1;break;case"$gte":if(r[e]<a)return!1;break;case"$lt":if(r[e]>=a)return!1;break;case"$lte":if(r[e]>a)return!1;break;case"$ne":if(r[e]===a)return!1;break;case"$in":for(o=!0,c=0,f=a.length;f>c;c++){if(u=a[c],i.isRegex(u)&&u.test(r[e])){o=!1;break}if(r[e]===u){o=!1;break}}if(o)return!1;break;case"$nin":if(l=r[e],h.call(a,l)>=0)return!1;break;case"$exists":if(a!==(null!=r[e]))return!1;break;case"$type":if(!i.isType(r[e],a))return!1;break;case"$mod":if(r[e]%a[0]!==a[1])return!1;break;case"$regex":if(!new RegExp(a).test(r[e]))return!1;break;default:if(!n.check(r[e],JSON.parse('{"'+s+'": '+JSON.stringify(a)+"}")))return!1}return!0},n={},n.check=function(r,e){var t,n,h,b;for(h in e){if(n=e[h],-1!==h.indexOf(".")){if(a(r,h,n))continue;return!1}if(i.isNumber(n)&&"$size"!==h){if(c(r[h],n))continue;return!1}if(i.isString(n)){if(l(r[h],n))continue;return!1}if(i.isRegex(n)){if(f(r[h],n))continue;return!1}if(b=o(r,h,n),null!=b){if(b)continue;return!1}if(t=s(r,h,n),null!=t){if(t)continue;return!1}if(!u(r,h,n))return!1}return!0},t.exports=n}),define("localdb/0.0.1/src/lib/update",[],function(r,e,t){"use strict";var n,i,s,u;s=r("localdb/0.0.1/src/lib/where"),i=r("localdb/0.0.1/src/lib/utils"),u=function(r,e,t,n){var u,a,o,c,f,l,h,b,g,d,p,$,k,y,v,m,x,O,j;switch(e){case"$inc":for(a in t)for(o=t[a],c=0,b=r.length;b>c;c++)u=r[c],s(u,n)&&i.isNumber(u[a])&&(u[a]=u[a]+o);break;case"$set":for(a in t)for(o=t[a],f=0,g=r.length;g>f;f++)u=r[f],s(u,n)&&null!=u[a]&&(u[a]=o);break;case"$mul":for(a in t)for(o=t[a],l=0,d=r.length;d>l;l++)u=r[l],s(u,n)&&i.isNumber(u[a])&&(u[a]=u[a]*o);break;case"$rename":for(a in t)for(o=t[a],h=0,p=r.length;p>h;h++)u=r[h],s(u,n)&&null!=u[a]&&(u[o]=u[a],delete u[a]);break;case"$unset":for(a in t)for(m=0,$=r.length;$>m;m++)u=r[m],s(u,n)&&null!=u[a]&&delete u[a];break;case"$min":for(a in t)for(o=t[a],x=0,k=r.length;k>x;x++)u=r[x],s(u,n)&&i.isNumber(u[a])&&(u[a]=Math.min(u[a],o));break;case"$max":for(a in t)for(o=t[a],O=0,y=r.length;y>O;O++)u=r[O],s(u,n)&&i.isNumber(u[a])&&(u[a]=Math.max(u[a],o));break;default:for(j=0,v=r.length;v>j;j++)u=r[j],s(u,n)&&null!=u[e]&&(u[e]=t)}return r},n=function(r,e,t){var n,i;for(n in e)i=e[n],r=u(r,n,i,t);return r},t.exports=n}),define("localdb/0.0.1/src/lib/where",[],function(r,e,t){"use strict";var n,i,s,u,a,o,c,f,l,h,b,g,d=[].indexOf||function(r){for(var e=0,t=this.length;t>e;e++)if(e in this&&this[e]===r)return e;return-1};n=r("localdb/0.0.1/src/lib/utils"),h=["$gt","$gte","$lt","$lte","$ne","$in","$nin","$and","$nor","$or","$not","$exists","$type","$mod","$regex","$all","$elemMatch","$size"],a=function(r){return d.call(h,r)>=0},i=function(r,e){var t,n;if(null==r)return!1;for(n in e){if(t=e[n],-1!==n.indexOf(".")){if(u(r,n,t))continue;return!1}if(!g(r,n,t))return!1;if(!o(r,n,t))return!1}return!0},u=function(r,e,t){var n;return n=e.split(".")[0],i(r[/\d/.test(n)?Number(n):n],new function(){this[e.substr(e.indexOf(".")+1)]=t})},g=function(r,e,t){var i;return a(e)?!0:(i=r[e],n.isNumber(t)&&!c(i,t)?!1:n.isString(t)&&!b(i,t)?!1:n.isRegex(t)&&!l(i,t)?!1:n.isArray(t)&&!s(i,t)?!1:n.isObject(t)&&!f(i,t)?!1:!0)},o=function(r,e,t){var s,u,a,c,f,l,h;switch(e){case"$gt":if(t>=r)return!1;break;case"$gte":if(t>r)return!1;break;case"$lt":if(r>=t)return!1;break;case"$lte":if(r>t)return!1;break;case"$ne":if(r===t)return!1;break;case"$in":if(!function(){var e,i,s;for(i=0,s=t.length;s>i;i++)if(e=t[i],n.isRegex(e)&&e.test(r)||r===e)return!0;return!1}())return!1;break;case"$nin":if(d.call(t,r)>=0)return!1;break;case"$exists":if(t!==(null!=r))return!1;break;case"$type":if(!n.isType(r,t))return!1;break;case"$mod":if(r%t[0]!==t[1])return!1;break;case"$regex":if(!new RegExp(t).test(r))return!1;break;case"$and":for(u=0,f=t.length;f>u;u++)if(s=t[u],!i(r,s))return!1;break;case"$nor":for(a=0,l=t.length;l>a;a++)if(s=t[a],i(r,s))return!1;break;case"$or":if(!function(){var e,n;for(e=0,n=t.length;n>e;e++)if(s=t[e],i(r,s))return!0;return!1}())return!1;break;case"$not":if(i(r,t))return!1;break;case"$all":if(!n.isArray(r))return!1;for(c=0,h=t.length;h>c;c++)if(s=t[c],!function(){var t,i,u;for(i=0,u=r.length;u>i;i++)if(t=r[i],n.isArray(s)?o(t,e,s):t===s)return!0}())return!1;break;case"$elemMatch":if(!n.isArray(r))return!1;if(!function(){var e,n,s;for(n=0,s=r.length;s>n;n++)if(e=r[n],i(e,t))return!0}())return!1;break;case"$size":if(!n.isArray(r))return!1;if(r.length!==t)return!1}return!0},c=function(r,e){return n.isNumber(r)&&e===r?!0:n.isArray(r)&&d.call(r,e)>=0?!0:!1},b=function(r,e){return n.isString(r)&&e===r?!0:n.isArray(r)&&d.call(r,e)>=0?!0:!1},l=function(r,e){var t,i,s;if(n.isString(r)&&e.test(r))return!0;if(n.isArray(r))for(i=0,s=r.length;s>i;i++)if(t=r[i],e.test(t))return!0;return!1},s=function(r,e){return n.isEqual(r,e)},f=function(r,e){var t,s,u;s=!0;for(u in e)if(t=e[u],a(u)&&(s=!1,!i(r,new function(){this[u]=t})))return!1;return s?n.isEqual(r,t):!0},t.exports=i});